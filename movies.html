<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .hover-shadow:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); 
            transform: scale(1.03); 
            transition: transform 0.2s, box-shadow 0.2s;
        }
    </style>

</head>

<body>
    <div id="movieGrid" class="container mt-4">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
            <div class="col" v-for="movie in movies" :key="movie.id">
                <div class="card h-100 shadow-sm hover-shadow" >
                    <img :src="'https://image.tmdb.org/t/p/w500/' + movie.poster_path" class="card-img-top" :alt="movie.original_title">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ movie.original_title }}</h5>
                        <p class="card-text">{{ movie.overview }}</p>
                        <a :href="'movie.html?id=' + movie.id" class="btn btn-primary mt-auto">More Info</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp, ref } = Vue
        createApp({
            setup() {
                const movies = ref([])

                return {
                    movies
                }
            },
            mounted() {
                console.log("Sigue logeado")


                let is_log = localStorage.getItem("is_log");
                let username = localStorage.getItem("username");
                if (is_log != null && username != null) {

                    window.location.href = "index.html";
                }

                const myHeaders = new Headers();

                myHeaders.append("Authorization", "Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhMGMwYWZhNTU1ZWZiNDU4YzQ0MzEzNTA4NmE2ZWFlMSIsIm5iZiI6MTcyODYxNTkwMS4wMDM2MzksInN1YiI6IjY3MDg1ODYyZjE4OTE5ZGQ0YzQ4MmVmMSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.l6L1Rw9NYORGN9IIE0ytQLzJaaDced3a6b-POSBiS8c");

                const requestOptions = {
                    method: "GET",
                    headers: myHeaders,
                    redirect: "follow"
                };

                fetch("https://api.themoviedb.org/3/discover/movie", requestOptions)
                    .then((response) => response.json())
                    .then((result) => {

                        console.log(result)

                        this.movies = result.results

                    })
                    .catch((error) => console.error(error));
            }

        }).mount('#movieGrid')

    </script>
</body>

</html>